\documentclass[usenames, dvipsnames, 10pt]{beamer}


\usepackage{default}
\usepackage{xltxtra}
\usepackage{fontspec}
\usepackage{latex-macros}
\usepackage{cancel}
\usetheme[block=fill, background=light, titleformat=smallcaps]{metropolis}
\usefonttheme{professionalfonts}
\usepackage{cleveref}
\usepackage[sort]{natbib}

% \setsansfont{CMU Sans Serif Demi Condensed}

\newcommand{\xstar}{x^{\star}}
\newcommand{\eps}{\varepsilon}

\theoremstyle{definition}
\newtheorem{proposition}{Proposition}

\usepackage{tikz,pgfplots}

\begin{document}

\title{On the convergence of the proximal algorithm for nonsmooth functions
involving analytic features}
\subtitle{Hedy Attouch, J{\'e}r{\^o}me Bolte}
\author{Presenter: \textsc{Vasilis Charisopoulos}}
\frame{\titlepage}
\frame{\tableofcontents}

\allowdisplaybreaks

%% INTRODUCTION: Problem motivation, difficulties and prior art
\section{Introduction}

\begin{frame}{Introduction}
Recall the definition of the \textit{proximal point} method:
\begin{equation}
    \color{MidnightBlue}
	x_{k+1} \in \mathrm{prox}_{\lambda_k f}
	:= \argmin_{u \in \Rbb^d} \set{
	f(u) + \frac{1}{2 \lambda_k} \norm{u - x_k}^2 }, \;
	x_0 \in \Rbb^d
	\label{eq:proximal-point-method}
\end{equation}
Our setting:
\begin{itemize}
	\item $f: \Rbb^d \to \overline{\Rbb}$: proper, lsc
	\item $0 < \lambda_- < \lambda_k < \lambda_+, \; \forall k$
	\item $\inf_{\Rbb^d} f > -\infty$
\end{itemize}
\end{frame}

\begin{frame}{Introduction}
	Two main questions:
	\begin{enumerate}
		\item Does the sequence defined by~\cref{eq:proximal-point-method}
			converge?
		\item Is there a generic way to say \textit{how fast} it does?
	\end{enumerate}

	\visible<2->{
		Tackle the latter using \textbf{{\L}ojasiewicz exponents}, which
		specialize the familiar Kurdyka-{\L}ojasiewicz property.
	}
\end{frame}

\section{Background}

\begin{frame}{Refresher}
	\begin{enumerate}
		\item \textbf{Critical points} of $f$: denote
			\begin{align*}
            {\color{MidnightBlue}
				\mathrm{crit}(f) := \set{x \in \dom f \mmid 0 \in \partial
				f(x)}},
			\end{align*}
			where $\partial f$ denotes the \textbf{limiting} subdifferential.
		\item For a proper lsc $f$ with $\inf f > -\infty$ it holds that
        \citep[Chapter 10]{RockWett98}:
			\[
                \color{MidnightBlue}
				x_{k+1} \in \mathrm{prox}_{\lambda_k f}
				\Leftrightarrow \frac{x_k - x_{k+1}}{\lambda_k} \in \partial
				f(x).
			\]
	\end{enumerate}
\end{frame}

\begin{frame}{{\L}ojasiewicz property}
	A slightly specialized version of the familiar KL property:
	\begin{definition} \label{defn:loj-exp}
		A function $f$ sat. the {\L}ojasiewicz property around $\hat{x} \in
		\mathrm{crit}(f)$ if $\exists C, \eps > 0, \theta \in [0, 1)$ such that
		\[ \color{MidnightBlue} \boxed{
			C \norm{v} \abs{f(x) - f(\hat{x})}^{1 - \theta} \geq 1, \;
			\forall v \in \partial f(x), \; \forall x \in \hat{x} + \eps
			\mathbf{B}}
		\]
	\end{definition}
	\textbf{Note}: the {\L}ojasiewicz property is a special case of the KL
	inequality with desingularizer $\varphi(s) = C s^{1 - \theta}$.
\end{frame}

\begin{frame}{Main takeaway}
	Two positive answers to our earlier questions:
	\begin{enumerate}
		\item Bounded sequences $\set{x_k}$ converge to critical points of $f$
		\item Rate of convergence is controlled by {\L}ojasiewicz exponent
	\end{enumerate}
\end{frame}

\section{Convergence: Preliminaries}

\begin{frame}{Proximal Point Sequences}
    \begin{proposition}[Proximal point sequences] \vspace{1pt}
    Consider $\set{x^k}_{k \in \Nbb}$ generated by the proximal point iteration,
    and $\cX(x^0)$ its limit points starting from $x^0$. Then:
    \begin{enumerate}
    \item \label{P1} $\set{f(x^k)}$ is nonincreasing,
    \item \label{P2} $\sum_k \norm{x^k - x^{k+1}}^2$ is finite,
    \item \label{P3}
    if $\set{x^k}$ bounded, then $\cX(x^0)$ compact, connected, and
    $\mathrm{dist}(\cX, x^k) \to 0$
    \item \label{P4} if $f$ continuous, $\cX(x^0) \subset \mathrm{crit}(f)$ and
    $f$ is
    constant on $\cX(x^0)$
    \end{enumerate}
    \end{proposition}
\end{frame}
\begin{frame}{Proximal point sequences}
    \begin{proof}[Proof sketch] \vspace{1pt}
        Item~\eqref{P1} follows from defn. of proximal point, and~\eqref{P2}
        follows after summing up. Item~\eqref{P3} was homework. For
        item~\eqref{P4}, denote $\xbar$ a limit point and
        \[
            (2) \to \lim_{k \to \infty} \norm{x^k - x^{k+1}}^2 = 0
            \Rightarrow \lim_{k \to \infty}
            \frac{1}{\lambda_k} \norm{g^k}^2 = 0, \;
        \]
        for $g^k \in \partial f(x)$,
        so $\cX(x^0) \subset \mathrm{crit}(f)$ since
        $(\xbar, 0) \in \gph \partial f$ by continuity of $f$.
    \end{proof}
\end{frame}

\begin{frame}{Consequences of L-property}
    If $K$ compact, $f$ satisfies L-property with exponent $\theta$:
    \[
        \color{MidnightBlue}
        \forall x \in K + \epsilon \mathbf{B}:
        \abs{f(x) - f(\xhat)}^{\theta} \leq C \mathrm{dist}_{\partial f(x)}(0).
    \]
    Proved by topological definition of compactness and L-property.

        $\implies$ $f$ is \textbf{constant} on any connected subset of its
        critical points.
\end{frame}

\begin{frame}{Functions satisfying L-property}
    Notable classes of functions satisfying the L-property:
    \begin{itemize}
    \item Real-analytic~\citep{Loja63} \& Sub-analytic
    functions~\citep{BolDanLew07}
    \item Convex functions exhibiting so-called \textbf{H{\"o}lderian}
    growth\footnote{Includes e.g. \textit{sharp} functions}:
    \[
        \color{MidnightBlue}
        f(x) - f^{\star} \geq C \left(\mathrm{dist}_{\argmin f}(x)\right)^{p},
        \;
        p \geq 1, \; \forall x \in \argmin f + \epsilon \mathbf{B}.
    \]
    (in particular, $\norm{x}^{p}, \; p \geq 1$)
    \end{itemize}
\end{frame}

\section{Main Results}
\subsection{Convergence}
\begin{frame}{Convergence \& an error bound}
    \begin{block}{\cite[Theorem 1]{AttBol09}} \vspace{1pt}
        Assume $f$ as before and a sequence $\set{x^k}$ from the proximal point
        iteration. If sequence is bounded, then
        \[	\color{MidnightBlue}
            \sum_k \norm{x^{k+1} - x^k} < \infty,
        \]
        and the whole sequence converges to some $\xbar \in \mathrm{crit}(f)$.
    \end{block}
\end{frame}
\begin{frame}{Proof sketch}
    As usual, assume wlog $\inf_k f(x^k) = 0$.
    Note: $f(x^k) \geq f(x^{k+1}) + (\lambda_k)^{-1} \norm{x^k - x^{k+1}}^2$
    from proximal point iteration. Use subgradient inequality on $x \mapsto
    -x^{1-\theta}$ to obtain
    \begin{align*}
        \color{MidnightBlue}
        {f(x^k)}^{1-\theta} - {f(x^{k+1})}^{1-\theta} \geq (1 - \theta)
        {f(x^k)}^{-\theta}
            \frac{\norm{x^{k+1} - x^k}^2}{2 \lambda_k},
    \end{align*}
    and the L-property for a large enough $k$ to obtain
    \begin{align*}
        \color{MidnightBlue}
        \frac{\norm{x^{k+1} - x^k}^2}{\norm{x^k - x^{k-1}}}
        \leq M \left(f(x^k)^{1-\theta} - f(x^{k+1})^{1-\theta}\right) \\
        \color{MidnightBlue}
        \overset{(\text{algebra...})}{\Rightarrow}
        \underbrace{\norm{x^{k+1} - x^k} \leq r \norm{x^k - x^{k-1}}
        + \frac{M}{r} \left(f(x^k)^{1-\theta} - f(x^{k+1})^{1-\theta}\right)}_{
        \text{error bound}}
    \end{align*}
    for some $\color{MidnightBlue} r \in (0, 1)$. ``Telescope'' both sides to
    obtain convergence, Cauchy property.
\end{frame}

\begin{frame}{Consequences of Theorem 1}
    \textbf{Example}:
    Suppose $f(x) = g(x) + \delta_{\cD}(x)$, $\cD$ compact. Then
    {\color{MidnightBlue}
    \begin{align*}
        \mathrm{prox}_{\lambda f}(x^k) & \equiv
        \argmin_{x \in \cD} \set{
            g(x) + \frac{1}{2 \lambda} \norm{x - x^k}^2}
            \Rightarrow \set{x^k}_{k \in \Nbb} \subset \cD,
    \end{align*}
    }
    so obtain convergence for free.
    Should also extend to prox-gradient.
\end{frame}

\subsection{Rate of convergence}

\begin{frame}{Deducing the rate of convergence}
    \begin{block}{\cite[Theorem 2]{AttBol09}}
        Assume L-property holds for $f$ around a limit point $x^{\star}$ of
        a bounded sequence $\set{x^k}$. Then:
        \begin{itemize}
        \item $\theta = 0$: converge in finite number of steps
        \item $\theta \in (0, 1/2]$: converge as $\norm{x^k - x^{\star}}
        = \cO(Q^k), \; Q < 1$
        \item $\theta \in (1/2, 1)$: converge as
        $\norm{x^k - x^{\star}} = \cO(k^{-\frac{1-\theta}{2\theta - 1}})$
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Proof Sketch}
    Denote $\Delta_k := \sum_{p = k}^{\infty} \norm{x^p - x^{p+1}}$, shown to
    be finite. Triangle inequality + algebra from error bound give
    \[  \color{MidnightBlue}
        \norm{x^k - x^{\star}} \leq \Delta_k \leq
        \frac{1}{1 - r} \left(\Delta_{k-1} - \Delta_k\right)
        + \tilde{C} \left(\Delta_{k-1}
        - \Delta_k\right)^{\frac{1 - \theta}{\theta}}.
    \]
    \begin{itemize}
    \item {$\theta \in (1/2, 1)$}:
    $\Delta_k \to 0$, big enough $k$ implies (after some
    algebra):
    \[  \color{MidnightBlue}
        0 \leq \mu(\theta) \leq \left(\Delta_{k-1}^{\frac{1 - 2\theta}{1 -
        \theta}} - \Delta_k^{\frac{1 - 2 \theta}{1 - \theta}} \right).
    \]
    Noticing $\frac{1 - 2\theta}{1 - \theta} < 0$, summing up for some
    large enough integers $N, N'$ gives:
    \[	\color{MidnightBlue}
        \Delta_N \leq c N^{-\frac{1-\theta}{2\theta - 1}}.
    \]
    \item {$\theta \in (0, 1/2]$}: $\frac{1-\theta}{\theta} = 1$ so obtain
    \[ \color{MidnightBlue}
        \Delta_k \leq \left(\tilde{C} + \frac{1}{1 - r}\right)
        \left(\Delta_{k-1} - \Delta_k\right). \]
    \end{itemize}
\end{frame}


%\begin{frame}{Mandatory slide with picture}
%    Example: $f(x) = \norm{x}_1 \Rightarrow
%    [x^{k+1}]_j = \begin{cases}
%        0, & \abs{[x^k]_j} \leq \lambda_k \\
%        [x^k]_j - \mathrm{sign}([x^k]_j) \lambda_k, & \text{o.w.}
%    \end{cases} $
%    \begin{figure}[h]
%        \begin{tikzpicture}% table
%        \begin{axis}[xlabel=$k$,ylabel=$\norm{x^k}^p$]
%        \addplot+ table[x expr=\coordindex+1,y index={0}] {code/test.csv};
%        \addplot+ table[x expr=\coordindex+1,y index={1}] {code/test.csv};
%        \addplot+ table[x expr=\coordindex+1,y index={2}] {code/test.csv};
%        \addplot+ table[x expr=\coordindex+1,y index={3}] {code/test.csv};
%        \addplot+ table[x expr=\coordindex+1,y index={4}] {code/test.csv};
%        \end{axis}
%        \end{tikzpicture}
%    \end{figure}
%\end{frame}

\begin{frame}
    \begin{center} \Large
    Thank You! \\ Questions?
    \end{center}
\end{frame}

\begin{frame}[allowframebreaks]{References}
\bibliographystyle{humannat}
%\bibliographystyle{plain}
\bibliography{references}
\end{frame}

\end{document}
